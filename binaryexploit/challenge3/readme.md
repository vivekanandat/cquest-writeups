i went kinda overboard with this question..so the explanation is gonna be complex

![image](https://github.com/user-attachments/assets/8260d462-674e-46fa-bea2-50388185fe7e)

printf(uname);

it says this function usage is unsafe.that is because it is vulnerable to format string inputs(%p %lx %d %s %x .....)

giveing %lx or %p to a printf funciton without specifying what it should pritn will print the values of registers followed by the values of stack.

![image](https://github.com/user-attachments/assets/331486bf-4571-4a38-95af-d0f230719c49)

here the first 5 values r the values of register and the rest r values of stack

before the 'printf(uname);' we stored the address of main fucntion in m but didnt use it so it is stored in stack . now that we can access the stack we can get its value

to do that we need to identify where in stack it is present.im using gdb for the analysis

![image](https://github.com/user-attachments/assets/93441a04-69ac-4090-be62-b0970d63781d)

b addes a breakpoint

r is used to run the program

disass disassembles the given fucntion

![image](https://github.com/user-attachments/assets/0de47326-1822-4303-bdcd-a9f2504811a6)

this pointer showes where we r in the program

![image](https://github.com/user-attachments/assets/7e091599-9073-40f8-a823-7c2dc2778cf5)

lets add a breakpoint after the second printf function

![image](https://github.com/user-attachments/assets/4d1169ea-379f-4ed6-b1a0-3b95d6f08dca)

b * addes a breakpoint at a given address

c is to continue after we hit a breakpoint

now lets print the stack

![image](https://github.com/user-attachments/assets/9454e3b1-7aac-4701-936d-cbca53c9e890)

x/40x $sp lets us see the first 40 bytes of the stack

![image](https://github.com/user-attachments/assets/865fe643-ada0-40d8-b046-38b909a07dbb)

now we need to search for the address of main in the stack

![image](https://github.com/user-attachments/assets/b7e9aeba-fe3a-44cf-8c26-ae3c7547c70b)

here it is .both the blocks are of 1 memory cell and since it follows little endian we have to read the cells backward(ie.0x00005555  0x555551e1)

it is in the 9th row i.e. it is in the 18th column.so we need to print the 18th column with the format sting vulnerablity

but since we have 5 registers before the stack it is the 23rd value

![image](https://github.com/user-attachments/assets/63fd77e1-740f-4951-a848-1e4e1bbb81e0)

now we have address of main .to get to the print_flag() funciton we need its address

we can get that with the address of main like the prev challenge

we have the same offset so substracting 68 from the main should give us the address value of print_flag() fuction

ie.

![image](https://github.com/user-attachments/assets/962a8307-aeff-471d-b08e-3d3dfd12fa5e)


source:'https://www.calculator.net/hex-calculator.html'

![image](https://github.com/user-attachments/assets/664fb23c-bfd9-428a-9789-d1da6bbad168)


and here we have our flag
